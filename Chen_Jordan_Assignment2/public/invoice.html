<script src="products_data.js">


</script>

<script>

//Process the submission form

  let params = (new URL(document.location)).searchParams;

</script>


<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>

  
  <table border="2">
    <tbody>
    
      <tr>
        <th style="text-align: center;" width="43%">Item</th>
        <th style="text-align: center;" width="11%">quantity</th>
        <th style="text-align: center;" width="13%">price</th>
        <th style="text-align: center;" width="54%">extended price</th>
      </tr>




      <script>

// Code used from Invoice 4 and reference from screencast
//Checks and display purchased items
        var Subtotal = 0;
        for (i in products) {
          if (params.has(`quantity${i}`)) { // Checking if ...
            a_qty = params.get(`quantity${i}`);
            if (a_qty == 0) continue;
            extended_prices = products[i].price * a_qty;
            Subtotal += extended_prices;
            document.write(`
          <tr>
            <td width="43%">${products[i].name}</td>
            <td align="center" width="11%">${a_qty}</td>
            <td width="13%">\$${products[i].price}</td>
            <td width="54%">\$${extended_prices}</td>
          </tr>
          `);
          }

        }

        // Calculate sales tax

        var tax_rate = 0.0575;
        var tax = tax_rate * Subtotal;

        //Shipping

        if (Subtotal <= 99.99) {

          Shipping = 2;
        }

        else if (Subtotal <= 199.99) {
          Shipping = 5;
        }

        else {

          Shipping = 0.05 * Subtotal;
        }

        // Total

        var total = Subtotal + tax + Shipping;

      </script>

      <tr>
        <td colspan="4" width="100%">&nbsp;</td>
      </tr>
      <tr>
        <td style="text-align: center;" colspan="3" width="67%">Sub-total</td>
        <td width="54%">$
          <script>document.write(Subtotal);</script>
        </td>
      </tr>
      <tr>
        <td style="text-align: center;" colspan="3" width="67%">
          <span style="font-family: arial;">Tax @
            <script> document.write(100 * tax_rate);</script> %
          </span>
        </td>
        <td width="54%">$
          <script>document.write(tax.toFixed(2));</script>
        </td>
      </tr>

      <tr>
        <td style="text-align: center;" colspan="3" width="67%"> Shipping </span></td>
        <td width="54%">$
          <script>document.write(Shipping.toFixed(2));</script>
        </td>
      </tr>

      <tr>
        <td style="text-align: center;" colspan="3" width="67%">
          <strong>Total</strong>
        </td>
        <td width="54%"><strong>$
            <script>document.write(total.toFixed(2));
            </script>
          </strong></td>
      </tr>

    </tbody>
  </table>
  <div>
    <br>
    OUR SHIPPING POLICY IS:A subtotal $0 - $99.99 will be $2 shipping
    A subtotal $100.00 - $199.99 will be $5 shipping
    Subtotals over $300 will be charged 5% of the subtotal amount
    </br>

  </div>

</body>

</html>