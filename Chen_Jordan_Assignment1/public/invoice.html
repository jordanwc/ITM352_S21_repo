<script>

var products = [
    {
        "name": "PS5",
        "price": 500.00,
        "image": "PS5.jpg"
    },

    {
        "name": "Xbox Series X",
        "price": 500.00,
        "image": "XboxX.jpg"
    },

    {
        "name": "PS4",
        "price": 400.00,
        "image": "PS4.jpg"
    },

    {
        "name": "Xbox 360",
        "price": 400.00,
        "image": "Xbox360.jpg"

    },

    {
        "name": "Nintendo Switch",
        "price": 300.00,
        "image": "Switch.jpg"

    }
];

</script>

<script>
 
let params = (new URL(document.location)).searchParams;
  var quantities = []; // Check that we have quantities submitted
  if (params.has('purchasesubmit')) { // If everything is good, create a loop for every product
    for (i = 0; i < products.length; i++) {
      if (params.has(`quantity${i}`)) { // Checking if ...
        a_qty = params.get(`quantity${i}`);
        quantities[i] = a_qty;
      }
    }
  } else {
    document.write('Please enter a valid quantity'); // If there is no valid quantity inputted, this will tell customers to select a valid quantity
  }
  console.log(quantities); // Print out the quantities in the table 
 

</script>


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    
    <table border="2">
        <tbody>
          <tr>
            <th style="text-align: center;" width="43%">Item</th>
            <th style="text-align: center;" width="11%">quantity</th>
            <th style="text-align: center;" width="13%">price</th>
            <th style="text-align: center;" width="54%">extended price</th>
          </tr>




<script>
      var Subtotal = 0;
      generate_item_rows(quantities);
      

// Calculate sales tax

var tax_rate = 0.0575;
var tax = tax_rate * Subtotal;

//Shipping

if(Subtotal <= 50) {

  Shipping = 2;
}

else if (Subtotal <= 100){
  Shipping = 5;
}

else {

  Shipping = 0.05 * Subtotal;
}

// Total

var total = Subtotal + tax + Shipping;

</script>

          <tr>
            <td colspan="4" width="100%">&nbsp;</td>
          </tr>
          <tr>
            <td style="text-align: center;" colspan="3" width="67%">Sub-total</td>
            <td width="54%">$<script>document.write(Subtotal);</script></td>
          </tr>
          <tr>
            <td style="text-align: center;" colspan="3" width="67%">
                <span style="font-family: arial;">Tax @ <script> document.write(100*tax_rate);</script> %</span></td>
            <td width="54%">$<script>document.write(tax.toFixed(2));</script></td>
          </tr>

          <tr>
            <td style="text-align: center;" colspan="3" width="67%"> Shipping </span></td>
            <td width="54%">$<script>document.write(Shipping.toFixed(2));</script></td>
          </tr>

          <tr>
            <td style="text-align: center;" colspan="3" width="67%">
                <strong>Total</strong></td>
            <td width="54%"><strong>$<script>document.write(total.toFixed(2));
            </script></strong></td>
          </tr>

        </tbody>
      </table>
      <div>
        <br>
        OUR SHIPPING POLICY IS:A subtotal $0 - $49.99 will be $2 shipping
        A subtotal $50 - $99.99 will be $5 shipping
        Subtotals over $100 will be charged 5% of the subtotal amount
      </br>
      
      </div>
      
</body>
</html>